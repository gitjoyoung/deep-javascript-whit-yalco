// ì½œë°± ì§€ì˜¥ callback hell
// setTimeout(() => {
//   console.log(1);
//   setTimeout(() => {
//     console.log(2);
//     setTimeout(() => {
//       console.log(3);
//       setTimeout(() => {
//         console.log(4);
//         setTimeout(() => {
//           console.log(5);
//         }, 500);
//       }, 500);
//     }, 500);
//   }, 500);
// }, 500);

// 1
// 2
// 3
// 4
// 5

// ì—°ì†ì ìœ¼ë¡œ ë¹„ë™ê¸° ì½”ë“œë¥¼ ì¨ì•¼ í•˜ëŠ” ê²½ìš°
// ìœ„ì™€ ê°™ì´ ì½œë°± í•¨ìˆ˜ ì•ˆì— ë˜ ë‹¤ë¥¸ ì½œë°± í•¨ìˆ˜ë¥¼ ë„£ì–´ì•¼ í•˜ëŠ” ìƒí™© ë°œìƒ - ì½œë°± ì§€ì˜¥
// íšŸìˆ˜ê°€ ë§ì„ìˆ˜ë¡ ê°€ë…ì„±ë„ ë‚®ì•„ì§€ê³  ì§ê´€ì„±ì´ ë–¨ì–´ì§
// ì‹¤ì „ì—ì„œëŠ” ë”ë”ìš± ë³µì¡í•˜ê³  ë‚œí•´í•´ì§

// ğŸƒğŸƒğŸƒ ë¦´ë ˆì´ ì˜ˆì œ
// ì² ìˆ˜, ì˜í¬, ëŒì¤€, ì •ì•„, ê¸¸ëˆì´ ì¹˜ë¡€ë¡œ ì´ì–´ë‹¬ë¦¬ê¸°ëŠ” í•˜ëŠ” ì½”ë“œ
// â­ ê° ê³¨ì¸ì‹œê°„ ê¸°ë¡ - ì´ì „ ì½œë°±í•¨ìˆ˜ì˜ ê²°ê³¼ê°€ ë‹¤ìŒ ì½œë°±í•¨ìˆ˜ë¡œ ë„˜ê²¨ì ¸ ì¶•ì ë¨
// í•œ ì£¼ìë¼ë„ ë°ë“œë¼ì¸(ë°€ë¦¬ì´ˆ)ì„ ë„˜ê¸°ë©´ ì‹¤íŒ¨ - ì£¼ìë§ˆë‹¤ ë‹¤ë¥¸ ì‹¤íŒ¨ ë©”ì‹œì§€ ì¶œë ¥
// ì™„ì£¼ ì‹¤íŒ¨ì‹œ ğŸ˜¢ ì™„ì£¼ ì‹¤íŒ¨ - ${ì „ì²´ ì†Œìš”ì‹œê°„} ì¶œë ¥
// ì‹¤íŒ¨ë“  ì„±ê³µì´ë“  ë§ˆì§€ë§‰ì— - - ê²½ê¸° ì¢…ë£Œ - - ì¶œë ¥

const DEADLINE = 1500;

function relayRun(name, start, nextFunc, failMsg) {
  console.log(`ğŸ‘Ÿ ${name} ì¶œë°œ`);
  const time = 1000 + Math.random() * 500;

  setTimeout(() => {
    if (time < DEADLINE) {
      console.log(`ğŸš© ${name} ë„ì°© - ${(start + time) / 1000}ì´ˆ`);
      nextFunc?.(start + time);
    } else {
      console.log(failMsg);
      console.log(`ğŸ˜¢ ì™„ì£¼ ì‹¤íŒ¨ - ${(start + time) / 1000}ì´ˆ`);
    }

    if (time >= DEADLINE || !nextFunc) {
      console.log("- - ê²½ê¸° ì¢…ë£Œ - -");
    }
  }, time);
}

relayRun(
  "ì² ìˆ˜",
  0,
  (start1) => {
    relayRun(
      "ì˜í¬",
      start1,
      (start2) => {
        relayRun(
          "ëŒì¤€",
          start2,
          (start3) => {
            relayRun(
              "ì •ì•„",
              start3,
              (start4) => {
                relayRun("ê¸¸ëˆ", start4, null, "ì•„ì•„, ì•„ê¹ìŠµë‹ˆë‹¤...");
              },
              "ì •ì•„ì—ê²Œ ë¬´ë¦¬ì˜€ë‚˜ë³´ë„¤ìš”."
            );
          },
          "ëŒì¤€ì´ ë¶„ë°œí•´ë¼."
        );
      },
      "ì˜í¬ê°€ ì™„ì£¼í•˜ì§€ ëª»í–ˆë„¤ìš”."
    );
  },
  "ì² ìˆ˜ë¶€í„° ê´‘íƒˆì…ë‹ˆë‹¤. ã… ã… "
);

// ğŸ‘Ÿ ì² ìˆ˜ ì¶œë°œ
// ğŸš© ì² ìˆ˜ ë„ì°© - 1.031435763151387ì´ˆ
// ğŸ‘Ÿ ì˜í¬ ì¶œë°œ
// ğŸš© ì˜í¬ ë„ì°© - 2.0819326401459355ì´ˆ
// ğŸ‘Ÿ ëŒì¤€ ì¶œë°œ
// ğŸš© ëŒì¤€ ë„ì°© - 3.2349140572990045ì´ˆ
// ğŸ‘Ÿ ì •ì•„ ì¶œë°œ
// ğŸš© ì •ì•„ ë„ì°© - 4.438166447233023ì´ˆ
// ğŸ‘Ÿ ê¸¸ëˆ ì¶œë°œ
// ğŸš© ê¸¸ëˆ ë„ì°© - 5.759755589990514ì´ˆ
// - - ê²½ê¸° ì¢…ë£Œ - -

// í”„ë¡œë¯¸ìŠ¤ promise
// (ë³´í†µ ì‹œê°„ì´ ê±¸ë¦¬ëŠ”) ì–´ë–¤ ê³¼ì • ì´í›„ ì£¼ì–´ì§„ ë™ì‘ì„ ì‹¤í–‰í•  ê²ƒì´ë€ ì•½ì†
// ì¤‘ì²©ëœ ë¹„ë™ê¸° ì½”ë“œë¥¼ ì§ê´€ì ì´ê³  ì—°ì†ì ì¸ ì½”ë“œë¡œ ì‘ì„±í•  ìˆ˜ ìˆë„ë¡ í•¨

const borrow = 20;

// ë¹Œë¦° ëˆì˜ 10%ë¥¼ ë”í•´ ê°’ê² ë‹¤ëŠ” ì•½ì†
// rejectëŠ” ì§€ê¸ˆ ì‚¬ìš©í•˜ì§€ ì•ŠìŒ
const payWith10perc = new Promise((resolve, reject) => {
  resolve(borrow * 1.1);
});

payWith10perc.then((result) => {
  console.log(result + "ë§Œì›");
});
// 22ë§Œì›

// ìƒì„±ì Promise
// ìƒˆë¡œìš´ ì•½ì†ì„ í•˜ëŠ” ì½”ë“œ
// ì¸ìë¡œ ë°›ëŠ” ì½œë°±í•¨ìˆ˜ì˜ ì²« ë²ˆì§¸ ì¸ì resolve ( ì´ë¦„ì€ ê´€ë¡€ ) - ì•½ì† ì´í–‰ ì„±ê³µì‹œ, ë°˜í™˜í•  ê°’ ë„£ì–´ ì‹¤í–‰
// í”„ë¡œë¯¸ìŠ¤ ì¸ìŠ¤í„´ìŠ¤ ( ë§Œë“¤ì–´ì§„ ì•½ì† ) ì˜ then ë©”ì„œë“œ
// resolveë¥¼ í†µí•´ ( ì•½ì†ëŒ€ë¡œ ) ë°˜í™˜ëœ ê²°ê³¼ë¥¼ ì¸ìë¡œ í•˜ëŠ” ì½œë°± í•¨ìˆ˜ë¥¼ ë„£ìŒ
// â­ ë˜ ë‹¤ë¥¸ í”„ë¡œë¯¸ìŠ¤ë¥¼ ë°˜í™˜ - ì²´ì´ë‹ ê°€ëŠ¥

const payWith10perc2 = new Promise((resolve, reject) => {
  // ğŸ’¡ ë‚´ë¶€ì—ì„œ ë¹„ë™ê¸° ì½”ë“œ ì‚¬ìš©
  setTimeout(() => {
    resolve(borrow * 1.1);
  }, 1000); // 1ì´ˆ í›„ ê°šê² ìŒ
});

// âš ï¸ ì½˜ì†”ì—ì„œ ë¶„ë¦¬í•´ì„œ ì‹¤í–‰í•˜ë©´ ì•ˆ ë¨!
// í”„ë¡œë¯¸ìŠ¤ê°€ ìƒì„±ë˜ëŠ” ìˆœê°„ë¶€í„° ì‹œê°„ ê²½ê³¼
payWith10perc2.then((result) => {
  console.log(result + "ë§Œì›");
});
// 22ë§Œì›